
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√†i t·∫≠p To√°n - C·ªông tr·ª´ trong ph·∫°m vi 100</title>
    <!-- T·∫£i Tailwind CSS ƒë·ªÉ t·∫°o ki·ªÉu d·ª±a tr√™n ti·ªán √≠ch -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- T·∫£i ph√¥ng ch·ªØ Inter t·ª´ Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* Ki·ªÉu c∆° b·∫£n cho ph·∫ßn th√¢n, √°p d·ª•ng ph√¥ng ch·ªØ Inter v√† n·ªÅn xanh nh·∫°t */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f9ff; /* M√†u xanh r·∫•t nh·∫°t */
            display: flex; /* S·ª≠ d·ª•ng flexbox ƒë·ªÉ cƒÉn gi·ªØa n·ªôi dung */
            align-items: center; /* CƒÉn gi·ªØa theo chi·ªÅu d·ªçc */
            justify-content: center; /* CƒÉn gi·ªØa theo chi·ªÅu ngang */
            min-height: 100vh; /* ƒê·∫£m b·∫£o ph·∫ßn th√¢n chi·∫øm to√†n b·ªô chi·ªÅu cao khung nh√¨n */
            margin: 0; /* X√≥a l·ªÅ m·∫∑c ƒë·ªãnh c·ªßa ph·∫ßn th√¢n */
        }
        /* Container cho n·ªôi dung ·ª©ng d·ª•ng ch√≠nh, v·ªõi chi·ªÅu r·ªông t·ªëi ƒëa ƒë·ªÉ ƒë√°p ·ª©ng */
        .container {
            max-width: 600px; /* Chi·ªÅu r·ªông t·ªëi ƒëa cho n·ªôi dung */
            width: 95%; /* Chi·ªÅu r·ªông ƒë√°p ·ª©ng */
            margin: 20px auto; /* L·ªÅ t·ª± ƒë·ªông ƒë·ªÉ cƒÉn gi·ªØa theo chi·ªÅu ngang, 20px theo chi·ªÅu d·ªçc */
            padding: 20px;
        }
        /* Ki·ªÉu th·∫ª cho c√°c m√†n h√¨nh (trang ch·ªß, b√†i ki·ªÉm tra, k·∫øt qu·∫£) */
        .card {
            background-color: #ffffff; /* N·ªÅn tr·∫Øng */
            border-radius: 12px; /* G√≥c bo tr√≤n */
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1); /* B√≥ng m·ªÅm ƒë·ªÉ t·∫°o chi·ªÅu s√¢u */
            padding: 30px; /* ƒê·ªám b√™n trong */
            position: relative; /* C·∫ßn thi·∫øt ƒë·ªÉ ƒë·ªãnh v·ªã n√∫t quay l·∫°i */
        }
        /* Ki·ªÉu cho c√°c ti√™u ƒë·ªÅ ch√≠nh tr√™n m√†n h√¨nh ch√≠nh v√† m√†n h√¨nh k·∫øt qu·∫£ */
        .home-title {
            font-size: 2rem; /* C·ª° ch·ªØ l·ªõn */
            font-weight: 700; /* ƒê·ªô ƒë·∫≠m c·ªßa ch·ªØ */
            color: #1e3a8a; /* M√†u xanh ƒë·∫≠m */
            text-align: center; /* CƒÉn gi·ªØa vƒÉn b·∫£n */
            margin-bottom: 2rem; /* Kho·∫£ng tr·ªëng b√™n d∆∞·ªõi ti√™u ƒë·ªÅ */
        }
        /* B·ªë c·ª•c l∆∞·ªõi cho c√°c n√∫t tab tr√™n m√†n h√¨nh ch√≠nh */
        .tab-grid {
            display: grid;
            /* L∆∞·ªõi ƒë√°p ·ª©ng: c·ªôt t·ª± ƒë·ªông l·∫•p ƒë·∫ßy, t·ªëi thi·ªÉu 120px, t·ªëi ƒëa 1fr */
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 1rem; /* Kho·∫£ng c√°ch gi·ªØa c√°c m·ª•c l∆∞·ªõi */
        }
        /* Ki·ªÉu cho t·ª´ng n√∫t tab */
        .tab-btn {
            padding: 1rem;
            font-size: 1rem;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease; /* Chuy·ªÉn ƒë·ªông m∆∞·ª£t m√† cho hi·ªáu ·ª©ng di chu·ªôt */
            background-color: #3b82f6; /* M√†u xanh d∆∞∆°ng m·∫∑c ƒë·ªãnh */
            color: white; /* Ch·ªØ tr·∫Øng */
            border: none;
            text-align: center;
            display: flex; /* S·ª≠ d·ª•ng flexbox ƒë·ªÉ cƒÉn gi·ªØa n·ªôi dung v√† ƒëi·ªÉm */
            flex-direction: column; /* S·∫Øp x·∫øp theo chi·ªÅu d·ªçc */
            justify-content: center;
            align-items: center;
        }
        /* Ki·ªÉu cho ƒëi·ªÉm s·ªë b√™n trong n√∫t tab */
        .tab-btn span {
            font-size: 0.8rem;
            font-weight: 400;
            margin-top: 0.25rem;
            color: rgba(255, 255, 255, 0.8);
        }
        .tab-btn:hover {
            background-color: #2563eb; /* Xanh ƒë·∫≠m h∆°n khi di chu·ªôt */
            transform: translateY(-2px); /* Hi·ªáu ·ª©ng nh·∫•c nh·∫π */
            box-shadow: 0 4px 15px rgba(0,0,0,0.1); /* B√≥ng l·ªõn h∆°n khi di chu·ªôt */
        }

        /* Th√™m c√°c ki·ªÉu m·ªõi cho tr·∫°ng th√°i ho√†n th√†nh c·ªßa n√∫t tab */
        .tab-btn.tab-btn-perfect {
            background-color: #22c55e; /* Xanh l√° c√¢y cho ƒëi·ªÉm t·ªëi ƒëa */
        }
        .tab-btn.tab-btn-perfect:hover {
            background-color: #16a34a;
        }

        .tab-btn.tab-btn-completed {
            background-color: #facc15; /* V√†ng cho ƒë√£ l√†m nh∆∞ng ch∆∞a t·ªëi ƒëa */
            color: #3f3f46; /* Ch·ªØ t·ªëi m√†u h∆°n cho n·ªÅn v√†ng */
        }
        .tab-btn.tab-btn-completed:hover {
            background-color: #eab308;
        }

        /* Ki·ªÉu cho vƒÉn b·∫£n c√¢u h·ªèi */
        .question-text {
            font-size: 1.5rem;
            font-weight: 600;
            color: #1e3a8a;
            margin-bottom: 20px;
            text-align: center; /* CƒÉn gi·ªØa vƒÉn b·∫£n c√¢u h·ªèi */
        }
        /* Ki·ªÉu cho c√°c n√∫t tr·∫£ l·ªùi */
        .answer-btn {
            display: block; /* ƒê·∫∑t c√°c n√∫t ·ªü c·∫•p kh·ªëi */
            width: 100%; /* Chi·ªÅu r·ªông ƒë·∫ßy ƒë·ªß */
            padding: 12px;
            margin-bottom: 10px;
            font-size: 1.125rem;
            text-align: left; /* CƒÉn tr√°i vƒÉn b·∫£n trong n√∫t */
            background-color: #e0f2fe; /* N·ªÅn xanh nh·∫°t */
            color: #0c4a6e; /* Ch·ªØ xanh ƒë·∫≠m */
            border: 2px solid transparent; /* Vi·ªÅn trong su·ªët */
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease; /* Chuy·ªÉn ƒë·ªông m∆∞·ª£t m√† */
        }
        .answer-btn:hover {
            background-color: #bae6fd; /* Xanh nh·∫°t h∆°n khi di chu·ªôt */
            border-color: #7dd3fc; /* Vi·ªÅn xanh khi di chu·ªôt */
        }
        /* Ki·ªÉu cho n√∫t tr·∫£ l·ªùi ƒë√£ ch·ªçn */
        .answer-btn.selected {
            background-color: #38bdf8; /* Xanh s√°ng h∆°n khi ch·ªçn */
            color: white;
            border-color: #0ea5e9;
        }
        /* Ki·ªÉu cho n√∫t tr·∫£ l·ªùi ƒë√∫ng */
        .answer-btn.correct {
            background-color: #22c55e; /* Xanh l√° c√¢y cho ƒë√∫ng */
            color: white;
            border-color: #16a34a;
        }
        /* Ki·ªÉu cho n√∫t tr·∫£ l·ªùi sai */
        .answer-btn.incorrect {
            background-color: #ef4444; /* ƒê·ªè cho sai */
            color: white;
            border-color: #dc2626;
        }
        /* Ki·ªÉu cho c√°c n√∫t ƒëi·ªÅu khi·ªÉn (Ti·∫øp theo, L√†m l·∫°i, Trang ch·ªß) */
        .control-btn {
            padding: 12px 24px;
            font-size: 1.125rem;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease; /* Th√™m transform cho hi·ªáu ·ª©ng di chu·ªôt */
            margin: 10px; /* L·ªÅ xung quanh c√°c n√∫t */
            box-shadow: 0 4px 6px rgba(0,0,0,0.1); /* B√≥ng m·ªÅm */
        }
        .control-btn:hover {
            transform: translateY(-2px); /* Hi·ªáu ·ª©ng nh·∫•c nh·∫π khi di chu·ªôt */
            box-shadow: 0 6px 10px rgba(0,0,0,0.15); /* B√≥ng tƒÉng c∆∞·ªùng */
        }
        /* Ki·ªÉu cho c√°c bi·ªÉu t∆∞·ª£ng ph·∫£n h·ªìi (d·∫•u t√≠ch/d·∫•u x) */
        .feedback-icon {
            margin-left: 8px;
            font-size: 1.2em; /* L·ªõn h∆°n m·ªôt ch√∫t so v·ªõi vƒÉn b·∫£n */
            vertical-align: middle; /* CƒÉn ch·ªânh v·ªõi vƒÉn b·∫£n */
        }
        /* Ki·ªÉu cho n√∫t quay l·∫°i trang ch·ªß */
        .back-btn {
            position: absolute; /* ƒê·ªãnh v·ªã tuy·ªát ƒë·ªëi */
            top: 20px;
            left: 20px;
            background: none; /* Kh√¥ng c√≥ n·ªÅn */
            border: none; /* Kh√¥ng c√≥ vi·ªÅn */
            font-size: 0.9rem;
            font-weight: 600;
            color: #6b7280; /* M√†u ch·ªØ x√°m */
            cursor: pointer;
            padding: 5px;
            transition: color 0.2s ease; /* Chuy·ªÉn ƒë·ªïi m√†u m∆∞·ª£t m√† */
        }
        .back-btn:hover {
            color: #1d4ed8; /* Xanh ƒë·∫≠m h∆°n khi di chu·ªôt */
        }
        /* Ki·ªÉu cho h√¨nh ·∫£nh k·∫øt qu·∫£ */
        #result-image {
            max-width: 200px;
            height: auto; /* Duy tr√¨ t·ª∑ l·ªá khung h√¨nh */
            display: none; /* ·∫®n theo m·∫∑c ƒë·ªãnh, hi·ªÉn th·ªã b·∫±ng JS */
            margin: 0 auto 1rem auto; /* CƒÉn gi·ªØa h√¨nh ·∫£nh v√† th√™m l·ªÅ d∆∞·ªõi */
            border-radius: 8px; /* G√≥c bo tr√≤n cho h√¨nh ·∫£nh */
            box-shadow: 0 4px 10px rgba(0,0,0,0.1); /* B√≥ng m·ªÅm */
        }
        /* N√∫t game */
.btn {
    display: inline-block;
    margin-top: 5px;
    padding: 10px 20px;
    font-size: 20px;
    font-weight: bold;
    color: white;
    text-decoration: none;
    border-radius: 50px;
    background: #4CAF50;
    box-shadow: 0 8px #999;
}

.btn:active {
    box-shadow: 0 3px #666;
    transform: translateY(5px);
}

.btn:hover {
    filter: brightness(1.1);
}
    </style>
</head>
<body>
    <div class="container">
    <a href="index.html" class="btn">üè† Quay l·∫°i Trang Ch·ªß</a>
        <!-- M√†n h√¨nh ch√≠nh: Cho ph√©p ch·ªçn c√°c tab b√†i t·∫≠p kh√°c nhau -->
        <div id="home-screen" class="card">
            <h1 class="home-title">Ch·ªçn b√†i t·∫≠p</h1>
            <div id="tab-container" class="tab-grid">
                <!-- C√°c n√∫t tab s·∫Ω ƒë∆∞·ª£c t·∫°o ƒë·ªông t·∫°i ƒë√¢y b·∫±ng JavaScript -->
            </div>
        </div>

        <!-- M√†n h√¨nh b√†i ki·ªÉm tra: Hi·ªÉn th·ªã c√¢u h·ªèi v√† c√°c l·ª±a ch·ªçn tr·∫£ l·ªùi -->
        <div id="quiz-screen" class="card hidden">
            <!-- N√∫t ƒë·ªÉ quay l·∫°i m√†n h√¨nh ch√≠nh -->
            <button id="back-to-home-from-quiz-btn" class="back-btn">&larr; Trang ch·ªß</button>
            <div id="quiz-header" class="pt-6">
                <h1 id="quiz-title" class="text-2xl font-bold text-center text-blue-700 mb-4"></h1>
                <p id="progress-text" class="text-sm text-center text-gray-600 mb-4"></p>
            </div>
            <div id="question-container" class="mb-6">
                <p id="question-text" class="question-text"></p>
                <div id="answer-buttons" class="grid grid-cols-1 sm:grid-cols-2 gap-3"></div>
            </div>
            <div id="controls" class="text-center">
                <!-- N√∫t ƒë·ªÉ chuy·ªÉn sang c√¢u h·ªèi ti·∫øp theo, ·∫©n cho ƒë·∫øn khi m·ªôt c√¢u tr·∫£ l·ªùi ƒë∆∞·ª£c ch·ªçn -->
                <button id="next-btn" class="control-btn bg-blue-500 hover:bg-blue-600 text-white hidden">C√¢u ti·∫øp theo</button>
            </div>
        </div>

        <!-- M√†n h√¨nh k·∫øt qu·∫£: Hi·ªÉn th·ªã ƒëi·ªÉm b√†i ki·ªÉm tra v√† th√¥ng ƒëi·ªáp ƒë·ªông vi√™n -->
        <div id="results-screen" class="card hidden text-center">
            <h1 class="home-title">K·∫øt qu·∫£</h1>
            <p id="score-text" class="text-2xl font-bold text-blue-800"></p>
            <!-- H√¨nh ·∫£nh ƒë·ªÉ cung c·∫•p ph·∫£n h·ªìi tr·ª±c quan d·ª±a tr√™n hi·ªáu su·∫•t -->
            <img id="result-image" src="" alt="H√¨nh ·∫£nh ch√∫c m·ª´ng" class="mx-auto my-4 rounded-lg shadow-md" style="max-width: 200px; display: none;">
            <p id="result-message" class="text-lg text-gray-700 my-3"></p>
            <div class="flex flex-wrap justify-center gap-4 mt-4">
                <!-- C√°c n√∫t ƒë·ªÉ l√†m l·∫°i b√†i ki·ªÉm tra ho·∫∑c quay l·∫°i m√†n h√¨nh ch√≠nh -->
                <button id="restart-btn" class="control-btn bg-green-500 hover:bg-green-600 text-white">L√†m l·∫°i</button>
                <button id="home-btn" class="control-btn bg-gray-500 hover:bg-gray-600 text-white">Quay v·ªÅ trang ch·ªß</button>
            </div>
        </div>
    </div>

    <script>
        // --- Tham chi·∫øu c√°c ph·∫ßn t·ª≠ DOM ---
        const homeScreen = document.getElementById('home-screen');
        const quizScreen = document.getElementById('quiz-screen');
        const resultsScreen = document.getElementById('results-screen');
        const tabContainer = document.getElementById('tab-container');
        const quizTitle = document.getElementById('quiz-title');
        const questionTextElement = document.getElementById('question-text');
        const answerButtonsElement = document.getElementById('answer-buttons');
        const nextButton = document.getElementById('next-btn');
        const progressTextElement = document.getElementById('progress-text');
        const scoreTextElement = document.getElementById('score-text');
        const resultImage = document.getElementById('result-image');
        const resultMessage = document.getElementById('result-message');
        const restartButton = document.getElementById('restart-btn');
        const homeButton = document.getElementById('home-btn');
        const backToHomeFromQuizBtn = document.getElementById('back-to-home-from-quiz-btn');

        // --- C√°c bi·∫øn tr·∫°ng th√°i c·ªßa b√†i ki·ªÉm tra ---
        const TOTAL_TABS = 500;
        const QUESTIONS_PER_QUIZ = 5;
        let allQuizzesData = [];
        let currentQuizIndex;
        let currentQuestionIndex;
        let score;
        let quizScores = {}; // ƒê·ªëi t∆∞·ª£ng ƒë·ªÉ l∆∞u tr·ªØ ƒëi·ªÉm s·ªë c·ªßa t·ª´ng b√†i t·∫≠p c·ª•c b·ªô

        // --- Logic t·∫°o c√¢u h·ªèi ---

        /**
         * T·∫°o m·ªôt b√†i to√°n c·ªông (s·ªë1 + s·ªë2) trong ƒë√≥ kh√¥ng c√≥ s·ªë nh·ªõ
         * khi c·ªông c√°c ch·ªØ s·ªë h√†ng ƒë∆°n v·ªã v√† t·ªïng nh·ªè h∆°n 100.
         * @returns {object} M·ªôt ƒë·ªëi t∆∞·ª£ng ch·ª©a s·ªë1, s·ªë2, ƒë√°p √°n v√† to√°n t·ª≠.
         */
        function generateNoCarryAddition() {
            let num1, num2, sum;
            do {
                num1 = Math.floor(Math.random() * 90) + 10; // T·∫°o s·ªë t·ª´ 10 ƒë·∫øn 99
                num2 = Math.floor(Math.random() * 90) + 10; // T·∫°o s·ªë t·ª´ 10 ƒë·∫øn 99
                sum = num1 + num2;
            } while (
                (num1 % 10) + (num2 % 10) >= 10 || // Ki·ªÉm tra s·ªë nh·ªõ ·ªü h√†ng ƒë∆°n v·ªã
                sum >= 100 // ƒê·∫£m b·∫£o t·ªïng nh·ªè h∆°n 100
            );
            return { num1, num2, answer: sum, op: '+' };
        }

        /**
         * T·∫°o m·ªôt b√†i to√°n tr·ª´ (s·ªë1 - s·ªë2) trong ƒë√≥ kh√¥ng c·∫ßn m∆∞·ª£n
         * t·ª´ ch·ªØ s·ªë h√†ng ch·ª•c v√† k·∫øt qu·∫£ l√† s·ªë d∆∞∆°ng.
         * @returns {object} M·ªôt ƒë·ªëi t∆∞·ª£ng ch·ª©a s·ªë1, s·ªë2, ƒë√°p √°n v√† to√°n t·ª≠.
         */
        function generateNoBorrowSubtraction() {
            let num1, num2, difference;
            do {
                num1 = Math.floor(Math.random() * 90) + 10; // T·∫°o s·ªë t·ª´ 10 ƒë·∫øn 99
                num2 = Math.floor(Math.random() * (num1 - 10)) + 1; // ƒê·∫£m b·∫£o s·ªë2 nh·ªè h∆°n s·ªë1
                difference = num1 - num2;
            } while (
                (num1 % 10) < (num2 % 10) || // Ki·ªÉm tra vi·ªác m∆∞·ª£n ·ªü h√†ng ƒë∆°n v·ªã
                difference <= 0 // ƒê·∫£m b·∫£o k·∫øt qu·∫£ l√† s·ªë d∆∞∆°ng
            );
            return { num1, num2, answer: difference, op: '-' };
        }

        /**
         * T·∫°o m·ªôt t·∫≠p h·ª£p c√°c c√¢u h·ªèi to√°n h·ªçc duy nh·∫•t cho m·ªôt b√†i ki·ªÉm tra.
         * C√°c c√¢u h·ªèi bao g·ªìm ph√©p c·ªông kh√¥ng nh·ªõ v√† ph√©p tr·ª´ kh√¥ng m∆∞·ª£n.
         * @param {number} numQuestions S·ªë l∆∞·ª£ng c√¢u h·ªèi mong mu·ªën.
         * @returns {Array<object>} M·ªôt m·∫£ng c√°c ƒë·ªëi t∆∞·ª£ng c√¢u h·ªèi.
         */
        function generateQuizQuestions(numQuestions) {
            const questions = new Set();
            while (questions.size < numQuestions) {
                const isAddition = Math.random() > 0.5;
                const problem = isAddition ? generateNoCarryAddition() : generateNoBorrowSubtraction();
                
                const questionText = `${problem.num1} ${problem.op} ${problem.num2} = ?`;
                const correctAnswer = problem.answer.toString();

                const options = new Set([correctAnswer]);
                while (options.size < 4) {
                    const wrongAnswerOffset = Math.floor(Math.random() * 9) - 4;
                    const wrongAnswer = problem.answer + wrongAnswerOffset;
                    if (wrongAnswer !== problem.answer && wrongAnswer > 0) {
                        options.add(wrongAnswer.toString());
                    }
                }
                
                const questionObject = {
                    question: questionText,
                    options: Array.from(options).sort(() => Math.random() - 0.5),
                    correctAnswer: correctAnswer
                };
                
                questions.add(JSON.stringify(questionObject)); 
            }
            return Array.from(questions).map(q => JSON.parse(q));
        }

        // --- Logic l∆∞u tr·ªØ c·ª•c b·ªô (localStorage) ---

        /**
         * T·∫£i t·∫•t c·∫£ ƒëi·ªÉm s·ªë ƒë√£ l∆∞u t·ª´ localStorage.
         * @returns {object} ƒê·ªëi t∆∞·ª£ng ch·ª©a ƒëi·ªÉm s·ªë c·ªßa c√°c b√†i t·∫≠p.
         */
        function loadScores() {
            try {
                const storedScores = localStorage.getItem('mathQuizScores');
                return storedScores ? JSON.parse(storedScores) : {};
            } catch (e) {
                console.error("L·ªói khi t·∫£i ƒëi·ªÉm s·ªë t·ª´ localStorage:", e);
                return {};
            }
        }

        /**
         * L∆∞u ƒëi·ªÉm s·ªë c·ªßa m·ªôt b√†i t·∫≠p v√†o localStorage.
         * @param {number} quizIndex Ch·ªâ m·ª•c c·ªßa b√†i t·∫≠p.
         * @param {number} score ƒêi·ªÉm ƒë·∫°t ƒë∆∞·ª£c.
         * @param {number} totalQuestions T·ªïng s·ªë c√¢u h·ªèi.
         */
        function saveScore(quizIndex, score, totalQuestions) {
            quizScores[`quiz_${quizIndex}`] = { score: score, total: totalQuestions };
            try {
                localStorage.setItem('mathQuizScores', JSON.stringify(quizScores));
            } catch (e) {
                console.error("L·ªói khi l∆∞u ƒëi·ªÉm s·ªë v√†o localStorage:", e);
            }
        }

        // --- Kh·ªüi t·∫°o ·ª©ng d·ª•ng ---

        /**
         * ·∫®n t·∫•t c·∫£ c√°c m√†n h√¨nh sau ƒë√≥ hi·ªÉn th·ªã m√†n h√¨nh ƒë∆∞·ª£c ch·ªâ ƒë·ªãnh.
         * @param {HTMLElement} screen Ph·∫ßn t·ª≠ m√†n h√¨nh ƒë·ªÉ hi·ªÉn th·ªã.
         */
        function showScreen(screen) {
            homeScreen.classList.add('hidden');
            quizScreen.classList.add('hidden');
            resultsScreen.classList.add('hidden');
            screen.classList.remove('hidden');
        }

        /**
         * Kh·ªüi t·∫°o ·ª©ng d·ª•ng b·∫±ng c√°ch t·∫°o d·ªØ li·ªáu b√†i ki·ªÉm tra v√† c√°c n√∫t tab.
         * T·∫£i ƒëi·ªÉm s·ªë ƒë√£ l∆∞u t·ª´ localStorage v√† hi·ªÉn th·ªã tr√™n c√°c n√∫t tab.
         */
        function initializeApplication() {
            quizScores = loadScores(); // T·∫£i ƒëi·ªÉm s·ªë ƒë√£ l∆∞u khi kh·ªüi t·∫°o

            // T·∫°o t·∫•t c·∫£ d·ªØ li·ªáu b√†i ki·ªÉm tra v√† c√°c n√∫t tab
            tabContainer.innerHTML = '';
            allQuizzesData = [];
            for (let i = 0; i < TOTAL_TABS; i++) {
                allQuizzesData.push(generateQuizQuestions(QUESTIONS_PER_QUIZ));
                const tabButton = document.createElement('button');
                tabButton.innerText = `B√†i ${i + 1}`; // VƒÉn b·∫£n ban ƒë·∫ßu
                tabButton.classList.add('tab-btn'); // √Åp d·ª•ng ki·ªÉu d√°ng
                
                // Hi·ªÉn th·ªã ƒëi·ªÉm s·ªë v√† thay ƒë·ªïi m√†u n√∫t n·∫øu ƒë√£ c√≥
                const savedScore = quizScores[`quiz_${i}`];
                if (savedScore) {
                    const scoreSpan = document.createElement('span');
                    scoreSpan.innerText = `ƒêi·ªÉm: ${savedScore.score}/${savedScore.total}`;
                    tabButton.appendChild(scoreSpan);

                    // Thay ƒë·ªïi m√†u n√∫t d·ª±a tr√™n ƒëi·ªÉm s·ªë
                    if (savedScore.score === savedScore.total) {
                        tabButton.classList.add('tab-btn-perfect'); // Xanh l√° c√¢y cho ƒëi·ªÉm t·ªëi ƒëa
                    } else {
                        tabButton.classList.add('tab-btn-completed'); // V√†ng cho ƒë√£ l√†m nh∆∞ng ch∆∞a t·ªëi ƒëa
                    }
                }

                tabButton.addEventListener('click', () => {
                    startQuiz(i);
                });
                tabContainer.appendChild(tabButton);
            }
            showScreen(homeScreen); // Hi·ªÉn th·ªã m√†n h√¨nh ch√≠nh sau khi kh·ªüi t·∫°o
        }
        
        // --- Logic b√†i ki·ªÉm tra ---

        /**
         * B·∫Øt ƒë·∫ßu m·ªôt b√†i ki·ªÉm tra m·ªõi v·ªõi ch·ªâ m·ª•c ƒë∆∞·ª£c ch·ªâ ƒë·ªãnh.
         * @param {number} quizIndex Ch·ªâ m·ª•c c·ªßa b√†i ki·ªÉm tra ƒë·ªÉ b·∫Øt ƒë·∫ßu.
         */
        function startQuiz(quizIndex) {
            currentQuizIndex = quizIndex;
            currentQuestionIndex = 0;
            score = 0;
            
            quizTitle.innerText = `B√†i t·∫≠p ${quizIndex + 1}`;
            showScreen(quizScreen);
            loadQuestion();
        }

        /**
         * T·∫£i v√† hi·ªÉn th·ªã c√¢u h·ªèi hi·ªán t·∫°i v√† c√°c l·ª±a ch·ªçn tr·∫£ l·ªùi c·ªßa n√≥.
         * N·∫øu t·∫•t c·∫£ c√°c c√¢u h·ªèi ƒë∆∞·ª£c tr·∫£ l·ªùi, n√≥ s·∫Ω hi·ªÉn th·ªã m√†n h√¨nh k·∫øt qu·∫£.
         */
        function loadQuestion() {
            resetState();
            const quizData = allQuizzesData[currentQuizIndex];
            if (currentQuestionIndex < quizData.length) {
                const currentQuestion = quizData[currentQuestionIndex];
                questionTextElement.innerText = currentQuestion.question;
                progressTextElement.innerText = `C√¢u h·ªèi ${currentQuestionIndex + 1} / ${quizData.length}`;

                currentQuestion.options.forEach(option => {
                    const button = document.createElement('button');
                    button.innerText = option;
                    button.classList.add('answer-btn');
                    button.addEventListener('click', () => selectAnswer(button, option, currentQuestion.correctAnswer));
                    answerButtonsElement.appendChild(button);
                });
            } else {
                showResults();
            }
        }

        /**
         * ƒê·∫∑t l·∫°i tr·∫°ng th√°i c·ªßa c√°c n√∫t tr·∫£ l·ªùi v√† ·∫©n n√∫t ti·∫øp theo.
         */
        function resetState() {
            nextButton.classList.add('hidden');
            while (answerButtonsElement.firstChild) {
                answerButtonsElement.removeChild(answerButtonsElement.firstChild);
            }
        }

        /**
         * X·ª≠ l√Ω l·ª±a ch·ªçn tr·∫£ l·ªùi c·ªßa ng∆∞·ªùi d√πng, cung c·∫•p ph·∫£n h·ªìi v√† c·∫≠p nh·∫≠t ƒëi·ªÉm s·ªë.
         * @param {HTMLButtonElement} selectedButton Ph·∫ßn t·ª≠ n√∫t ƒë√£ ƒë∆∞·ª£c nh·∫•p.
         * @param {string} selectedOption N·ªôi dung vƒÉn b·∫£n c·ªßa t√πy ch·ªçn ƒë√£ ch·ªçn.
         * @param {string} correctAnswer C√¢u tr·∫£ l·ªùi ƒë√∫ng cho c√¢u h·ªèi hi·ªán t·∫°i.
         */
        function selectAnswer(selectedButton, selectedOption, correctAnswer) {
            Array.from(answerButtonsElement.children).forEach(button => {
                button.disabled = true;
                if (button.innerText === correctAnswer) {
                    button.classList.add('correct');
                    button.innerHTML += ' <span class="feedback-icon">‚úî</span>';
                }
                if (button === selectedButton) {
                    button.classList.add('selected');
                    if (selectedOption === correctAnswer) {
                        score++;
                    } else {
                        button.classList.add('incorrect');
                        button.innerHTML += ' <span class="feedback-icon">‚úò</span>';
                    }
                }
            });
            nextButton.classList.remove('hidden');
        }

        /**
         * Hi·ªÉn th·ªã k·∫øt qu·∫£ cu·ªëi c√πng c·ªßa b√†i ki·ªÉm tra, bao g·ªìm ƒëi·ªÉm s·ªë, th√¥ng b√°o v√† h√¨nh ·∫£nh.
         * C≈©ng l∆∞u ƒëi·ªÉm s·ªë v√†o localStorage.
         */
        async function showResults() {
            showScreen(resultsScreen);
            const quizData = allQuizzesData[currentQuizIndex];
            scoreTextElement.innerText = `B·∫°n ƒë√£ ƒë·∫°t ${score} / ${quizData.length} ƒëi·ªÉm.`;

            const percentage = score / quizData.length;
            if (percentage >= 0.8) {
                resultMessage.innerText = "Xu·∫•t s·∫Øc! B√© gi·ªèi qu√°!";
                resultImage.src = "https://placehold.co/200x150/4CAF50/FFFFFF?text=Tuy%E1%BB%87t+v%E1%BB%9Di%21";
            } else if (percentage >= 0.5) {
                resultMessage.innerText = "R·∫•t t·ªët! C·ªë g·∫Øng th√™m ch√∫t n·ªØa nh√©!";
                resultImage.src = "https://placehold.co/200x150/FFC107/000000?text=Kh%C3%A1+l%E1%BA%AFm%21";
            } else {
                resultMessage.innerText = "Kh√¥ng sao! H√£y th·ª≠ l·∫°i v√† h·ªçc th√™m nh√©!";
                resultImage.src = "https://placehold.co/200x150/F44336/FFFFFF?text=C%E1%BB%91+g%E1%BA%AFng+nha%21";
            }
            resultImage.style.display = 'block';

            // --- L∆∞u ƒëi·ªÉm v√†o localStorage ---
            saveScore(currentQuizIndex, score, quizData.length);
            // Sau khi l∆∞u ƒëi·ªÉm, c·∫≠p nh·∫≠t l·∫°i c√°c n√∫t tab ƒë·ªÉ hi·ªÉn th·ªã tr·∫°ng th√°i m·ªõi
            initializeApplication(); 
        }

        // --- Tr√¨nh l·∫Øng nghe s·ª± ki·ªán ---
        nextButton.addEventListener('click', () => {
            currentQuestionIndex++;
            loadQuestion();
        });

        restartButton.addEventListener('click', () => {
             startQuiz(currentQuizIndex);
        });
        
        const goHome = () => {
            showScreen(homeScreen);
            initializeApplication(); // C·∫≠p nh·∫≠t l·∫°i c√°c tab khi v·ªÅ trang ch·ªß
        }
        
        homeButton.addEventListener('click', goHome);
        backToHomeFromQuizBtn.addEventListener('click', goHome);

        // --- Kh·ªüi ƒë·ªông ·ª©ng d·ª•ng ---
        // Kh·ªüi t·∫°o ·ª©ng d·ª•ng sau khi n·ªôi dung DOM ƒë√£ ƒë∆∞·ª£c t·∫£i ho√†n to√†n
        document.addEventListener('DOMContentLoaded', initializeApplication);
    </script>
<!-- Cloudflare Pages Analytics --><script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "eed08efb2b414db28f2f6473bf39c1a2"}'></script><!-- Cloudflare Pages Analytics --></body>
</html>
